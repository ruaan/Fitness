<div class="modal-header">
  <button type="button" class="close" onclick="clearmodal();" data-dismiss="modal" aria-hidden="true">&times;</button>
  <h4 class="modal-title" id="myModalLabel">Add Product to Quote.</h4>
</div>

<div class="modal-body">
  <%= form_for(@lineitem, remote: false) do |f| %>
      <% if @lineitem.errors.any? %>
          <div id="error_explanation">
            <h2><%= pluralize(@lineitem.errors.count, "error") %> prohibited this product from being saved:</h2>
            <ul>
              <% @lineitem.errors.full_messages.each do |msg| %>
                  <li><%= msg %></li>
              <% end %>
            </ul>
          </div>
      <% end %>
      <div class="row add-margin-bottom">
        <div class="col-md-12">
          <div class="form-group">
            <%= f.label :title %><br>
            <%= f.text_field :title %>
          </div>
          <div class="form-group">
            <%= f.label :title %><br>
            <%= f.text_field :title %>
          </div>

          <div class="form-group">
            <%= f.label :sku %><br>
            <%= f.text_field :sku %>
          </div>

          <div class="form-group">
            <%= f.label :quantity %><br>
            <%= f.text_field :quantity %>
          </div>
          <div class="form-group">
            <%= f.label :price %><br>
            <%= f.text_field :price %>
          </div>
        </div>
        <div class="col-md-12">
          <div class="form-group">
            <%= f.label :description, :readonly=>true %><br>
            <%= @lineitem.description %>
          </div>
          <div class="form-group">
            <%= f.label :subdescription, :readonly=>true %><br>
            <%= @lineitem.subdescription %>
          </div>
        </div>
      </div>
      <div class="row" >
        <div  class="col-md-12" style="background-color: #e9e9e9;">
          <h4 style="font-weight:bold;">Select section to add products to: </h4>
          <div class="form-group">
            <ul>
              <% count = 0%>
              <% @projectid = params[:project_id].to_i %>
              <% Section.all.each do |section| %>
                  <%  if section.project_id == @projectid %>
                      <li id="nosub" class="hide"><%= section.name %></li>
                      <ul>
                        <% for subsection in section.subsections %>
                            <%  if section.project_id == @projectid %>
                                <script>$('#checkallbox').hide();$('#nosub').hide();</script>
                                <% count = count +1 %>
                                <% if count > 1 %>
                                    <li><%= check_box_tag "lineitem[subsection_ids][]", subsection.id, @lineitem.subsection_ids.include?(subsection.id), id: dom_id(subsection), class:"selectbox validate[required]" %>
                                      <script>$('#checkallbox').show();$('#nosub').show();</script>
                                <% else %>
                                    <li><%= check_box_tag "lineitem[subsection_ids][]", subsection.id, @lineitem.subsection_ids.include?(subsection.id), id: dom_id(subsection), checked:true, class:"selectbox validate[required]" %>
                                <% end %>

                                <%= label_tag dom_id(subsection), subsection.name %><br></li>
                            <% else %>
                            <% end %>
                        <% end %>
                  <% end %>
                  </ul>
              <% end %>
            </ul>
          </div>
          <div id="checkallbox">
            <input type="checkbox" id="checkAll"/>
            <label for="checkAll">Check all sections</label>
          </div>
        </div>
      </div>
      <div class="actions">
        <button type="button" onclick="clearmodal();" class="btn btn-default" data-dismiss="modal">Close</button>
        <%= f.submit  "Save" , :class => "btn btn-primary"%>
      </div>
      </div>


  <% end %>